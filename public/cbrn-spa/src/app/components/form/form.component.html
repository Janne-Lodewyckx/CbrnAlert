<form [formGroup]="formGroup" (ngSubmit)="onSubmit()">
    <span *ngFor="let formItem of form.formItems">
        <mat-form-field 
            *ngIf="formItem.type == 'input'" 
            class="form-control" 
            appearance="outline" 
            floatLabel="never">
            <mat-label> {{ formItem.label }} </mat-label>
            <input 
                *ngIf="formItem.value !== undefined"
                matInput
                [formControl]="formItem.controlName | formControl"
                [value]="
                    formItem.value.withPipe !== undefined 
                    ? (formItem.value.display | dynamicPipe: formItem.value.withPipe.pipe:formItem.value.withPipe.arg)
                    : formItem.value.display">
            <input 
                *ngIf="formItem.value === undefined"
                matInput
                [formControl]="formItem.controlName | formControl"
                >
            <mat-hint *ngIf="formItem.hint !== undefined">{{ formItem.hint }}</mat-hint>
            <mat-error *ngIf="(formItem.controlName | formControl).invalid"> error ! </mat-error>
        </mat-form-field>
        <mat-form-field 
            *ngIf="formItem.type == 'select'" 
            class="form-control" 
            appearance="outline" 
            floatLabel="never">
            <mat-label> {{ formItem.label }} </mat-label>
            <select matNativeControl [formControl]="formItem.controlName | formControl">
                <ng-container *ngIf="formItem.value !== undefined">
                    <option 
                        *ngFor="let obj of formItem.value.obj; let i = index;"
                        [ngValue]="obj">
                        {{ formItem.value.withPipe !== undefined 
                            ? (formItem.value.display[i] | dynamicPipe: formItem.value.withPipe.pipe:formItem.value.withPipe.arg)
                            : formItem.value.display[i] }} 
                    </option>
                </ng-container>
            </select>
            <mat-hint *ngIf="formItem.hint !== undefined">{{ formItem.hint }}</mat-hint>
            <mat-error *ngIf="(formItem.controlName | formControl).invalid"> error ! </mat-error>
        </mat-form-field>
        <mat-form-field 
            *ngIf="formItem.type == 'datepicker'" 
            class="form-control" 
            appearance="outline" 
            floatLabel="never">
            <mat-label> {{ formItem.label }} </mat-label>
            <input
                *ngIf="formItem.minMaxDate !== undefined"
                matInput 
                [matDatepicker]="picker" 
                [min]="formItem.minMaxDate.min" 
                [max]="formItem.minMaxDate.max" 
                [formControl]="formItem.controlName | formControl">
            <input
                *ngIf="formItem.minMaxDate === undefined"
                matInput 
                [matDatepicker]="picker" 
                [formControl]="formItem.controlName | formControl">
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
        </mat-form-field>
    </span>
    <button 
        mat-raised-button 
        color="primary" 
        type="submit" 
        [disabled]="formGroup.invalid">Send data request</button>
</form>